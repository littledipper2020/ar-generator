<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One Talk Auto Receptionist Generator</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700;9..40,800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --surface-2: #1a1a26;
    --surface-3: #111118;
    --border: #1e1e2e;
    --border-2: #2a2a3d;
    --text: #e8e8f0;
    --text-mid: #b0b0c8;
    --text-dim: #8888a0;
    --text-mute: #55556a;
    --red: #ee0000;
    --red-2: #ff4444;
    --red-3: #ee3333;
    --red-glow: rgba(238,0,0,0.35);
    --red-soft: rgba(238,0,0,0.06);
    --red-border: rgba(238,0,0,0.2);
    --green: #22c55e;
    --green-soft: rgba(34,197,94,0.08);
    --radius: 8px;
    --radius-lg: 10px;
    --radius-xl: 12px;
    --radius-2xl: 14px;
    --radius-3xl: 16px;
    --font: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --mono: 'Space Mono', monospace;
  }
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: var(--font); background: var(--bg); color: var(--text); min-height: 100vh; line-height: 1.5; }
  ::selection { background: rgba(238,0,0,0.25); }
  input, textarea, select, button { font-family: inherit; }
  textarea { resize: vertical; }

  /* â”€â”€ LAYOUT â”€â”€ */
  .app { max-width: 880px; margin: 0 auto; padding: 0 20px 40px; }

  /* â”€â”€ HEADER â”€â”€ */
  .header { padding: 32px 0 28px; border-bottom: 1px solid var(--border); }
  .header-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 12px; }
  .logo-row { display: flex; align-items: center; gap: 12px; }
  .logo-mark { width: 40px; height: 40px; border-radius: var(--radius-lg); background: var(--red); display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 15px; color: #fff; box-shadow: 0 0 24px var(--red-glow); letter-spacing: -0.02em; }
  .logo-text { font-weight: 700; font-size: 16px; letter-spacing: -0.02em; }
  .logo-sub { color: var(--text-dim); font-weight: 400; }
  .badge { font-family: var(--mono); font-size: 11px; color: var(--red-2); background: rgba(238,0,0,0.08); border: 1px solid var(--red-border); padding: 5px 12px; border-radius: 20px; letter-spacing: 0.04em; }
  .header h1 { font-size: 28px; font-weight: 800; letter-spacing: -0.03em; line-height: 1.2; margin-bottom: 8px; }
  .header p { color: var(--text-dim); font-size: 14px; line-height: 1.6; max-width: 600px; }

  /* â”€â”€ PROGRESS BAR â”€â”€ */
  .progress-bar { display: flex; gap: 6px; background: var(--surface-3); border-radius: var(--radius-2xl); padding: 8px; margin: 24px 0; border: 1px solid var(--border); overflow-x: auto; }
  .progress-step { flex: 1; display: flex; align-items: center; gap: 10px; padding: 10px 14px; border-radius: var(--radius-lg); background: transparent; border: none; color: var(--text); text-align: left; transition: all 0.2s; cursor: default; opacity: 0.4; min-width: 0; }
  .progress-step.active { background: var(--surface-2); opacity: 1; cursor: pointer; }
  .progress-step.done { background: var(--green-soft); opacity: 1; cursor: pointer; }
  .progress-step.clickable { cursor: pointer; }
  .step-circle { width: 30px; height: 30px; border-radius: 50%; border: 2px solid var(--border-2); display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; flex-shrink: 0; transition: all 0.2s; }
  .progress-step.active .step-circle { border-color: var(--red); color: var(--red); }
  .progress-step.done .step-circle { border-color: var(--green); background: var(--green); color: #000; }
  .step-label { font-weight: 600; font-size: 13px; white-space: nowrap; }
  .step-sub { font-size: 11px; color: var(--text-mute); white-space: nowrap; }

  /* â”€â”€ CONTENT PANEL â”€â”€ */
  .content { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-3xl); padding: 32px 28px; }
  .section-head { margin-bottom: 28px; }
  .section-head h2 { font-size: 22px; font-weight: 700; letter-spacing: -0.02em; }
  .section-head p { color: var(--text-dim); font-size: 14px; margin-top: 4px; }

  /* â”€â”€ FORM â”€â”€ */
  .field { margin-bottom: 22px; }
  .field-label { display: block; font-weight: 600; font-size: 13px; color: var(--text-mid); margin-bottom: 6px; }
  .field-label .req { color: var(--red); }
  .field-label .hint { font-weight: 400; color: var(--text-mute); font-size: 12px; }
  .field-hint { color: var(--text-mute); font-size: 12px; margin-bottom: 10px; margin-top: 2px; line-height: 1.4; }
  .input { width: 100%; padding: 10px 14px; background: var(--surface-2); border: 1px solid var(--border-2); border-radius: var(--radius); color: var(--text); font-size: 14px; outline: none; transition: border-color 0.2s; }
  .input:focus { border-color: var(--red); box-shadow: 0 0 0 3px rgba(238,0,0,0.1); }
  select.input { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238888a0' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 12px center; padding-right: 32px; }
  select.input option { background: var(--surface-2); color: var(--text); }

  /* â”€â”€ GRIDS â”€â”€ */
  .industry-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 8px; }
  .industry-card { padding: 14px 10px; background: var(--surface-2); border: 2px solid var(--border-2); border-radius: var(--radius-lg); cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 6px; transition: all 0.15s; color: var(--text); font-size: 12px; font-weight: 600; text-align: center; }
  .industry-card:hover { border-color: #3d3d5c; background: #222233; }
  .industry-card.active { border-color: var(--red); background: var(--red-soft); box-shadow: 0 0 20px rgba(238,0,0,0.12); }
  .industry-card .icon { font-size: 26px; }

  .tone-row { display: flex; gap: 10px; flex-wrap: wrap; }
  .tone-card { flex: 1 1 140px; padding: 14px 12px; background: var(--surface-2); border: 2px solid var(--border-2); border-radius: var(--radius-lg); cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 4px; transition: all 0.15s; color: var(--text); font-size: 13px; }
  .tone-card:hover { border-color: #3d3d5c; }
  .tone-card.active { border-color: var(--red); background: var(--red-soft); }
  .tone-card .desc { font-size: 11px; color: var(--text-mute); }

  /* â”€â”€ DEPARTMENTS â”€â”€ */
  .dept-header { display: flex; gap: 10px; padding: 0 14px 6px; font-size: 11px; color: var(--text-mute); font-weight: 600; text-transform: uppercase; letter-spacing: 0.06em; }
  .dept-header .col-name { flex: 2; }
  .dept-header .col-key { width: 70px; text-align: center; }
  .dept-header .col-ring { width: 150px; }
  .dept-header .col-del { width: 34px; }
  .dept-row { display: flex; gap: 10px; align-items: center; padding: 8px 10px; background: var(--surface-2); border: 1px solid var(--border-2); border-radius: var(--radius-lg); margin-bottom: 8px; animation: fadeIn 0.25s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  .dept-row .input-name { flex: 2; }
  .dept-row .input-key { width: 70px; text-align: center; font-family: var(--mono); font-weight: 700; }
  .dept-row .input-ring { width: 150px; }
  .remove-btn { width: 34px; height: 34px; border-radius: 50%; border: none; background: transparent; color: var(--text-mute); cursor: pointer; font-size: 20px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all 0.15s; }
  .remove-btn:hover { background: rgba(238,0,0,0.15); color: var(--red); }
  .add-btn { margin-top: 4px; padding: 8px 18px; background: transparent; border: 1px dashed var(--border-2); border-radius: var(--radius); color: var(--text-dim); cursor: pointer; font-size: 13px; font-weight: 600; width: 100%; transition: all 0.15s; }
  .add-btn:hover { border-color: var(--text-mute); color: var(--text); }

  .sep { border-top: 1px solid var(--border); margin: 20px 0; }
  .opt-row { display: flex; gap: 24px; align-items: flex-end; flex-wrap: wrap; }
  .check-label { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text-mid); cursor: pointer; margin-bottom: 22px; }
  .check-label input { width: 18px; height: 18px; accent-color: var(--red); cursor: pointer; }

  /* â”€â”€ AFTER HOURS / BOXES â”€â”€ */
  .ah-box { background: var(--surface-3); border-radius: var(--radius-xl); padding: 20px; border: 1px solid var(--border); margin-bottom: 22px; }
  .ah-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
  .toggle { width: 48px; height: 26px; border-radius: 13px; border: none; position: relative; cursor: pointer; transition: background 0.2s; flex-shrink: 0; }
  .toggle.on { background: var(--red-3); }
  .toggle.off { background: var(--border-2); }
  .toggle-knob { width: 20px; height: 20px; border-radius: 50%; background: #fff; position: absolute; top: 3px; transition: left 0.2s; }
  .toggle.on .toggle-knob { left: 25px; }
  .toggle.off .toggle-knob { left: 3px; }

  /* â”€â”€ SCRIPT â”€â”€ */
  .script-box { background: var(--surface-3); border-radius: var(--radius-xl); padding: 20px; border: 1px solid var(--border); }
  .script-label { font-size: 13px; font-weight: 700; color: var(--red-3); margin-bottom: 12px; }
  .script-area { width: 100%; padding: 14px; background: #0e0e16; border: 1px solid var(--border); border-radius: var(--radius); color: var(--text); font-family: var(--font); font-size: 14px; line-height: 1.8; min-height: 160px; outline: none; }
  .script-area:focus { border-color: var(--red); box-shadow: 0 0 0 3px rgba(238,0,0,0.1); }
  .script-stats { display: flex; gap: 12px; margin-top: 16px; padding: 14px; background: #0e0e16; border-radius: var(--radius); }
  .stat { flex: 1; text-align: center; }
  .stat-val { font-size: 22px; font-weight: 700; color: var(--red-3); font-family: var(--mono); }
  .stat-lbl { font-size: 12px; color: var(--text-dim); margin-top: 2px; }

  .config-box { background: var(--surface-3); border-radius: var(--radius-xl); padding: 20px; border: 1px solid var(--border); margin-top: 20px; }
  .config-label { font-size: 13px; font-weight: 700; color: var(--text-mid); margin-bottom: 12px; }
  .config-pre { font-family: var(--mono); font-size: 12px; color: var(--text-dim); line-height: 1.7; white-space: pre-wrap; margin: 0; }
  .final-pre { font-family: var(--font); font-size: 14px; color: #c8c8d8; line-height: 1.8; white-space: pre-wrap; margin: 0; }

  /* â”€â”€ BUTTONS â”€â”€ */
  .btn-primary { padding: 11px 22px; background: var(--red); color: #fff; border: none; border-radius: var(--radius); font-size: 14px; font-weight: 700; cursor: pointer; box-shadow: 0 2px 16px rgba(238,0,0,0.3); transition: all 0.2s; }
  .btn-primary:hover { filter: brightness(1.15); transform: translateY(-1px); }
  .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
  .btn-secondary { padding: 11px 22px; background: var(--surface-2); color: var(--text); border: 1px solid var(--border-2); border-radius: var(--radius); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s; }
  .btn-secondary:hover { border-color: #3d3d5c; background: #222233; }

  /* â”€â”€ NAV / EXPORT â”€â”€ */
  .nav-row { display: flex; justify-content: space-between; margin-top: 20px; }
  .export-btns { display: flex; gap: 12px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
  .email-box { background: var(--surface-3); border-radius: var(--radius-xl); padding: 20px; border: 1px solid var(--border); margin-top: 24px; }
  .email-row { display: flex; gap: 10px; margin-top: 10px; }

  /* â”€â”€ PHASE 2 â”€â”€ */
  .phase2 { background: linear-gradient(135deg, rgba(238,0,0,0.04), rgba(238,0,0,0.01)); border: 2px dashed var(--red-border); border-radius: var(--radius-2xl); padding: 32px; text-align: center; margin-top: 28px; }
  .phase2 h3 { margin-bottom: 6px; color: var(--red-3); }
  .phase2 p { color: var(--text-dim); max-width: 480px; margin: 0 auto; font-size: 14px; line-height: 1.6; }
  .voice-grid { display: flex; gap: 12px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
  .voice-card { padding: 16px; background: var(--surface); border: 1px solid var(--border-2); border-radius: var(--radius-lg); width: 140px; text-align: center; font-size: 13px; }
  .cs-badge { display: inline-block; background: rgba(238,0,0,0.12); color: var(--red-2); padding: 3px 10px; border-radius: 12px; font-size: 10px; font-weight: 700; margin-top: 8px; }

  .footer { text-align: center; padding: 32px 0 8px; color: var(--text-mute); font-size: 13px; }
  .footer .red { color: var(--red-3); }

  /* â”€â”€ STEP VISIBILITY â”€â”€ */
  .step-panel { display: none; }
  .step-panel.visible { display: block; animation: fadeIn 0.35s ease; }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 640px) {
    .header h1 { font-size: 22px; }
    .content { padding: 24px 18px; }
    .dept-header .col-ring, .dept-row .input-ring { display: none; }
    .step-sub { display: none; }
    .progress-step { padding: 8px 10px; }
  }
</style>
</head>
<body>
<div class="app" id="app">

  <!-- HEADER -->
  <header class="header">
    <div class="header-top">
      <div class="logo-row">
        <div class="logo-mark">OT</div>
        <div>
          <div class="logo-text">One Talk <span class="logo-sub">Auto Receptionist</span></div>
        </div>
      </div>
      <div class="badge">PHASE 1 â€” SCRIPT GENERATOR</div>
    </div>
    <h1>Automated Receptionist Generator</h1>
    <p>Build professional auto-attendant scripts for Verizon One Talk in minutes. Choose an industry template, customize departments, and generate a ready-to-use script.</p>
  </header>

  <!-- PROGRESS BAR -->
  <div class="progress-bar" id="progressBar"></div>

  <!-- CONTENT -->
  <div class="content">

    <!-- â•â•â• STEP 1 â•â•â• -->
    <div class="step-panel visible" id="step1">
      <div class="section-head">
        <h2>Business Information</h2>
        <p>Start with the basics â€” we'll use this to build your custom script.</p>
      </div>

      <div class="field">
        <label class="field-label">Business Name <span class="req">*</span></label>
        <input type="text" class="input" id="businessName" placeholder="e.g. Acme Dental Group">
      </div>

      <div class="field">
        <label class="field-label">Industry Template</label>
        <p class="field-hint">Select your industry to pre-fill departments and messaging.</p>
        <div class="industry-grid" id="industryGrid"></div>
      </div>

      <div class="field">
        <label class="field-label">Greeting Tone</label>
        <div class="tone-row" id="toneRow"></div>
      </div>

      <div class="field">
        <label class="field-label">Business Hours <span class="hint">(optional)</span></label>
        <input type="text" class="input" id="businessHours" placeholder="e.g. Monday â€“ Friday, 9:00 AM â€“ 5:00 PM" value="Monday â€“ Friday, 9:00 AM â€“ 5:00 PM">
      </div>
    </div>

    <!-- â•â•â• STEP 2 â•â•â• -->
    <div class="step-panel" id="step2">
      <div class="section-head">
        <h2>Call Routing & Departments</h2>
        <p>Configure your phone menu. Each department maps to an extension key press in One Talk.</p>
      </div>

      <div class="dept-header">
        <span class="col-name">Department</span>
        <span class="col-key">Key</span>
        <span class="col-ring">Ring Type</span>
        <span class="col-del"></span>
      </div>
      <div id="deptList"></div>
      <button class="add-btn" onclick="addDepartment()">+ Add Department</button>

      <div class="sep"></div>
      <div class="opt-row">
        <div class="field" style="flex: 0 0 auto; margin-bottom: 0;">
          <label class="field-label">Operator Extension</label>
          <input type="text" class="input" id="operatorExt" value="0" maxlength="2" style="width:70px; text-align:center; font-family:var(--mono); font-weight:700;">
        </div>
        <label class="check-label">
          <input type="checkbox" id="includeSpanish">
          Include Spanish language option
        </label>
      </div>

      <div class="sep"></div>

      <div class="ah-box">
        <div class="ah-top">
          <div>
            <strong style="font-size:15px">After-Hours Greeting</strong>
            <p class="field-hint" style="margin-bottom:0">Plays outside of business hours</p>
          </div>
          <button class="toggle on" id="ahToggle" onclick="toggleAfterHours()">
            <div class="toggle-knob"></div>
          </button>
        </div>
        <div id="ahContent">
          <textarea class="input" id="afterHoursMsg" rows="3" placeholder="" style="min-height:80px; margin-top:8px;"></textarea>
        </div>
      </div>

      <div class="field">
        <label class="field-label">Special Instructions <span class="hint">(optional)</span></label>
        <textarea class="input" id="specialInstructions" rows="3" placeholder="e.g. If you know your party's extension, you may dial it at any time." style="min-height:80px;"></textarea>
      </div>
    </div>

    <!-- â•â•â• STEP 3 â•â•â• -->
    <div class="step-panel" id="step3">
      <div class="section-head">
        <h2>Review & Edit Script</h2>
        <p>Your generated script is below. Feel free to edit it directly â€” changes are preserved.</p>
      </div>

      <div class="script-box">
        <div class="script-label">ğŸ“ Main Greeting</div>
        <textarea class="script-area" id="mainScript" rows="10"></textarea>
        <div class="script-stats" id="scriptStats"></div>
      </div>

      <div class="script-box" id="ahScriptBox" style="margin-top:20px; display:none;">
        <div class="script-label">ğŸŒ™ After-Hours Greeting</div>
        <textarea class="script-area" id="ahScript" rows="8"></textarea>
      </div>

      <div class="config-box">
        <div class="config-label">ğŸ“‹ One Talk Configuration Summary</div>
        <pre class="config-pre" id="configPreview3"></pre>
      </div>
    </div>

    <!-- â•â•â• STEP 4 â•â•â• -->
    <div class="step-panel" id="step4">
      <div style="text-align:center; padding:20px 0 10px;">
        <div style="font-size:56px; margin-bottom:12px;">ğŸ‰</div>
        <h2 style="font-size:24px; font-weight:700; margin-bottom:6px;">Your Script is Ready!</h2>
        <p style="color:var(--text-dim); max-width:500px; margin:0 auto;">Copy the script, share it with your team, or send it via email to get started with One Talk.</p>
      </div>

      <div class="export-btns">
        <button class="btn-primary" onclick="copyFullScript()" id="copyBtn">ğŸ“‹ Copy Full Script</button>
        <button class="btn-secondary" onclick="copyConfig()">ğŸ“„ Copy Config Summary</button>
      </div>

      <div class="script-box" style="margin-top:24px;">
        <div class="script-label">Main Greeting</div>
        <pre class="final-pre" id="finalMain"></pre>
      </div>
      <div class="script-box" id="finalAhBox" style="margin-top:16px; display:none;">
        <div class="script-label">After-Hours Greeting</div>
        <pre class="final-pre" id="finalAh"></pre>
      </div>

      <div class="config-box">
        <div class="config-label">One Talk Configuration Summary</div>
        <pre class="config-pre" id="configPreview4"></pre>
      </div>

      <!-- Email -->
      <div class="email-box">
        <strong>Send Script via Email</strong>
        <p class="field-hint">A copy will also be sent to onetalk@officecommunications.net</p>
        <div class="email-row">
          <input type="email" class="input" id="emailInput" placeholder="your@email.com" style="flex:1;">
          <button class="btn-primary" id="sendBtn" onclick="sendToWebhook()" style="min-width:100px;">Send</button>
        </div>
      </div>

      <!-- Phase 2 Teaser -->
      <div class="phase2">
        <div style="font-size:36px; margin-bottom:8px;">ğŸ”Š</div>
        <h3>Coming Soon â€” Phase 2: AI Voice Generation</h3>
        <p>Connect to ElevenLabs to generate professional audio files directly from your script. Choose from dozens of natural-sounding voices and download MP3/WAV files ready to upload to One Talk.</p>
        <div class="voice-grid">
          <div class="voice-card">
            <div style="font-size:28px; margin-bottom:4px;">ğŸ™ï¸</div>
            <strong>Rachel</strong>
            <div style="font-size:12px; color:var(--text-dim);">Warm, professional female</div>
            <div class="cs-badge">Coming Soon</div>
          </div>
          <div class="voice-card">
            <div style="font-size:28px; margin-bottom:4px;">ğŸ™ï¸</div>
            <strong>Adam</strong>
            <div style="font-size:12px; color:var(--text-dim);">Clear, authoritative male</div>
            <div class="cs-badge">Coming Soon</div>
          </div>
          <div class="voice-card">
            <div style="font-size:28px; margin-bottom:4px;">ğŸ™ï¸</div>
            <strong>Bella</strong>
            <div style="font-size:12px; color:var(--text-dim);">Friendly, approachable female</div>
            <div class="cs-badge">Coming Soon</div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- NAV -->
  <div class="nav-row" id="navRow"></div>

  <footer class="footer">Built for Verizon One Talk partners Â· <span class="red">Office Communications</span></footer>

</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const templates = {
  general: {
    name: "General Business", icon: "ğŸ¢",
    departments: [
      { name: "Sales", extension: "1", ring: "simultaneous" },
      { name: "Support", extension: "2", ring: "simultaneous" },
    ],
    afterHours: "Please leave a message and we will return your call during business hours.",
  },
  medical: {
    name: "Healthcare", icon: "ğŸ¥",
    departments: [
      { name: "Appointments", extension: "1", ring: "simultaneous" },
      { name: "Billing", extension: "2", ring: "sequential" },
      { name: "Pharmacy", extension: "3", ring: "sequential" },
      { name: "Nurse Line", extension: "4", ring: "simultaneous" },
    ],
    afterHours: "If this is a medical emergency, please hang up and dial 911. For urgent matters, press 9 to reach our on-call provider. Otherwise, please leave a detailed message.",
  },
  legal: {
    name: "Legal / Law Firm", icon: "âš–ï¸",
    departments: [
      { name: "New Client Intake", extension: "1", ring: "simultaneous" },
      { name: "Existing Cases", extension: "2", ring: "sequential" },
      { name: "Billing", extension: "3", ring: "sequential" },
    ],
    afterHours: "Our office is currently closed. Please leave a detailed message with your name and case number, and an attorney will return your call within one business day.",
  },
  retail: {
    name: "Retail", icon: "ğŸ›ï¸",
    departments: [
      { name: "Sales", extension: "1", ring: "simultaneous" },
      { name: "Customer Service", extension: "2", ring: "simultaneous" },
      { name: "Returns", extension: "3", ring: "sequential" },
    ],
    afterHours: "Please leave a message or visit our website for online orders.",
  },
  professional: {
    name: "Professional Services", icon: "ğŸ’¼",
    departments: [
      { name: "Consulting", extension: "1", ring: "sequential" },
      { name: "Support", extension: "2", ring: "simultaneous" },
    ],
    afterHours: "Leave a message and we will get back to you during office hours.",
  },
  restaurant: {
    name: "Restaurant", icon: "ğŸ½ï¸",
    departments: [
      { name: "Reservations", extension: "1", ring: "simultaneous" },
      { name: "Takeout / Delivery", extension: "2", ring: "simultaneous" },
      { name: "Events & Catering", extension: "3", ring: "sequential" },
    ],
    afterHours: "We are currently closed. Visit our website for reservations or online ordering.",
  },
  automotive: {
    name: "Automotive", icon: "ğŸš—",
    departments: [
      { name: "Sales", extension: "1", ring: "simultaneous" },
      { name: "Service", extension: "2", ring: "sequential" },
      { name: "Parts", extension: "3", ring: "sequential" },
    ],
    afterHours: "To schedule service or inquire about vehicle availability, please leave a message.",
  },
  realestate: {
    name: "Real Estate", icon: "ğŸ ",
    departments: [
      { name: "Sales / Listings", extension: "1", ring: "simultaneous" },
      { name: "Property Mgmt", extension: "2", ring: "sequential" },
      { name: "Leasing", extension: "3", ring: "simultaneous" },
    ],
    afterHours: "Our office is currently closed. Leave a message with your name and the property you're inquiring about, and an agent will return your call.",
  },
};

const tones = {
  professional: { name: "Professional", icon: "ğŸ‘”", desc: "Formal & polished" },
  friendly: { name: "Friendly", icon: "ğŸ˜Š", desc: "Warm & welcoming" },
  efficient: { name: "Efficient", icon: "âš¡", desc: "Brief & direct" },
};

const STEPS = [
  { num: 1, label: "Business Info", sub: "Name, industry & tone" },
  { num: 2, label: "Call Routing", sub: "Departments & hours" },
  { num: 3, label: "Review Script", sub: "Edit & customize" },
  { num: 4, label: "Export", sub: "Download & send" },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentStep = 1;
let selectedIndustry = "general";
let selectedTone = "professional";
let departments = JSON.parse(JSON.stringify(templates.general.departments));
let afterHoursEnabled = true;
let generatedMain = "";
let generatedAH = "";

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function init() {
  renderProgress();
  renderIndustryGrid();
  renderToneRow();
  renderDepartments();
  updateAfterHoursPlaceholder();
  renderNav();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS BAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderProgress() {
  const bar = document.getElementById("progressBar");
  bar.innerHTML = STEPS.map(s => {
    let cls = "progress-step";
    if (s.num === currentStep) cls += " active";
    else if (s.num < currentStep) cls += " done clickable";
    const onclick = s.num <= currentStep ? `goToStep(${s.num})` : "";
    return `<button class="${cls}" ${onclick ? `onclick="${onclick}"` : ""}>
      <div class="step-circle">${s.num < currentStep ? "âœ“" : s.num}</div>
      <div><div class="step-label">${s.label}</div><div class="step-sub">${s.sub}</div></div>
    </button>`;
  }).join("");
}

function goToStep(n) {
  if (n === 3 && currentStep === 2) generateScript();
  if (n <= currentStep) {
    currentStep = n;
    showStep();
  }
}

function showStep() {
  document.querySelectorAll(".step-panel").forEach((el, i) => {
    el.classList.toggle("visible", i + 1 === currentStep);
  });
  renderProgress();
  renderNav();
  window.scrollTo({ top: 0, behavior: "smooth" });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderNav() {
  const nav = document.getElementById("navRow");
  let html = "";
  if (currentStep > 1) {
    html += `<button class="btn-secondary" onclick="prevStep()">â† Previous</button>`;
  } else {
    html += `<div></div>`;
  }
  if (currentStep < 4) {
    const label = currentStep === 2 ? "Generate Script â†’" : "Next â†’";
    const disabled = currentStep === 1 && !document.getElementById("businessName")?.value.trim();
    html += `<button class="btn-primary" onclick="nextStep()" ${disabled ? "disabled" : ""}>${label}</button>`;
  }
  nav.innerHTML = html;
}

function nextStep() {
  if (currentStep === 1 && !document.getElementById("businessName").value.trim()) return;
  if (currentStep === 2) {
    if (!departments.some(d => d.name.trim())) return;
    generateScript();
  }
  currentStep = Math.min(currentStep + 1, 4);
  showStep();
  if (currentStep === 4) renderStep4();
}

function prevStep() {
  currentStep = Math.max(currentStep - 1, 1);
  showStep();
}

// Re-check next button validity on name input
document.addEventListener("input", e => {
  if (e.target.id === "businessName") renderNav();
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INDUSTRY GRID
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderIndustryGrid() {
  const grid = document.getElementById("industryGrid");
  grid.innerHTML = Object.entries(templates).map(([key, t]) =>
    `<div class="industry-card ${selectedIndustry === key ? "active" : ""}" onclick="selectIndustry('${key}')">
      <span class="icon">${t.icon}</span>
      <span>${t.name}</span>
    </div>`
  ).join("");
}

function selectIndustry(key) {
  selectedIndustry = key;
  departments = JSON.parse(JSON.stringify(templates[key].departments));
  renderIndustryGrid();
  renderDepartments();
  updateAfterHoursPlaceholder();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TONE ROW
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderToneRow() {
  const row = document.getElementById("toneRow");
  row.innerHTML = Object.entries(tones).map(([key, t]) =>
    `<div class="tone-card ${selectedTone === key ? "active" : ""}" onclick="selectTone('${key}')">
      <span style="font-size:22px">${t.icon}</span>
      <strong>${t.name}</strong>
      <span class="desc">${t.desc}</span>
    </div>`
  ).join("");
}

function selectTone(key) {
  selectedTone = key;
  renderToneRow();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DEPARTMENTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderDepartments() {
  const list = document.getElementById("deptList");
  list.innerHTML = departments.map((d, i) =>
    `<div class="dept-row">
      <input class="input input-name" value="${escHtml(d.name)}" placeholder="Department name" oninput="deptChange(${i},'name',this.value)">
      <input class="input input-key" value="${escHtml(d.extension)}" maxlength="2" oninput="deptChange(${i},'extension',this.value)">
      <select class="input input-ring" onchange="deptChange(${i},'ring',this.value)">
        <option value="simultaneous" ${d.ring === "simultaneous" ? "selected" : ""}>Ring All</option>
        <option value="sequential" ${d.ring === "sequential" ? "selected" : ""}>Ring in Order</option>
      </select>
      <button class="remove-btn" onclick="removeDept(${i})" title="Remove">Ã—</button>
    </div>`
  ).join("");
}

function deptChange(i, field, val) {
  departments[i][field] = val;
}

function addDepartment() {
  const nextExt = String(Math.max(...departments.map(d => parseInt(d.extension) || 0), 0) + 1);
  departments.push({ name: "", extension: nextExt, ring: "simultaneous" });
  renderDepartments();
}

function removeDept(i) {
  departments.splice(i, 1);
  renderDepartments();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AFTER HOURS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleAfterHours() {
  afterHoursEnabled = !afterHoursEnabled;
  const btn = document.getElementById("ahToggle");
  btn.className = afterHoursEnabled ? "toggle on" : "toggle off";
  document.getElementById("ahContent").style.display = afterHoursEnabled ? "block" : "none";
}

function updateAfterHoursPlaceholder() {
  const ta = document.getElementById("afterHoursMsg");
  if (ta) ta.placeholder = templates[selectedIndustry].afterHours + " (default â€” edit to customize)";
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCRIPT GENERATION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function generateScript() {
  const biz = document.getElementById("businessName").value.trim() || "[Business Name]";
  const hours = document.getElementById("businessHours").value.trim();
  const opExt = document.getElementById("operatorExt").value.trim();
  const spanish = document.getElementById("includeSpanish").checked;
  const special = document.getElementById("specialInstructions").value.trim();
  const ahMsg = document.getElementById("afterHoursMsg").value.trim();

  // Greeting
  let greeting;
  if (selectedTone === "friendly") greeting = `Hello and thank you for calling ${biz}! We're glad you reached out.`;
  else if (selectedTone === "efficient") greeting = `Thank you for calling ${biz}.`;
  else greeting = `Thank you for calling ${biz}. Your call is important to us.`;

  const hoursLine = hours ? `\nOur office hours are ${hours}.` : "";
  const spanishLine = spanish ? `\nPara espaÃ±ol, oprima el ${departments.length + 1}.` : "";

  let menu = "\n\nPlease listen carefully, as our menu options may have changed.";
  departments.forEach(d => {
    if (d.name.trim()) menu += `\nFor ${d.name}, press ${d.extension}.`;
  });
  if (opExt) menu += `\nTo speak with an operator, press ${opExt}.`;
  menu += "\nTo repeat these options, press the star key.";

  const specialLine = special ? `\n\n${special}` : "";
  generatedMain = `${greeting}${hoursLine}${spanishLine}${menu}${specialLine}`;

  // After-hours
  generatedAH = "";
  if (afterHoursEnabled) {
    const customMsg = ahMsg || templates[selectedIndustry].afterHours;
    generatedAH = `Thank you for calling ${biz}. Our office is currently closed.`;
    if (hours) generatedAH += `\n${hoursLine.trim()}`;
    generatedAH += `\n\n${customMsg}`;
    generatedAH += "\n\nPlease leave a message after the tone with your name, number, and a brief description of your inquiry, and we will return your call as soon as possible.";
    if (selectedIndustry === "medical") generatedAH += "\n\nIf this is a medical emergency, please hang up and dial 911 immediately.";
  }

  // Populate Step 3
  document.getElementById("mainScript").value = generatedMain;
  updateScriptStats();

  if (generatedAH) {
    document.getElementById("ahScriptBox").style.display = "block";
    document.getElementById("ahScript").value = generatedAH;
  } else {
    document.getElementById("ahScriptBox").style.display = "none";
  }

  document.getElementById("configPreview3").textContent = buildConfig();
}

function updateScriptStats() {
  const text = document.getElementById("mainScript").value;
  const words = text.split(/\s+/).filter(Boolean).length;
  const dur = Math.ceil(words / 2.5);
  const opts = departments.filter(d => d.name.trim()).length;
  document.getElementById("scriptStats").innerHTML = `
    <div class="stat"><div class="stat-val">${words}</div><div class="stat-lbl">Words</div></div>
    <div class="stat"><div class="stat-val">${dur}s</div><div class="stat-lbl">Est. Duration</div></div>
    <div class="stat"><div class="stat-val">${opts}</div><div class="stat-lbl">Menu Options</div></div>
  `;
}

// Live stats update
document.addEventListener("input", e => {
  if (e.target.id === "mainScript") updateScriptStats();
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIG SUMMARY
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildConfig() {
  const biz = document.getElementById("businessName").value.trim() || "â€”";
  const hours = document.getElementById("businessHours").value.trim() || "Not specified";
  const opExt = document.getElementById("operatorExt").value.trim();
  const spanish = document.getElementById("includeSpanish").checked;

  const lines = [];
  lines.push(`BUSINESS: ${biz}`);
  lines.push(`INDUSTRY: ${templates[selectedIndustry].name}`);
  lines.push(`HOURS: ${hours}`);
  lines.push("");
  lines.push("MENU TREE:");
  departments.forEach(d => {
    if (d.name.trim()) lines.push(`  Press ${d.extension} â†’ ${d.name} (${d.ring === "simultaneous" ? "Ring All" : "Ring in Order"})`);
  });
  if (opExt) lines.push(`  Press ${opExt} â†’ Operator`);
  if (spanish) lines.push(`  Press ${departments.length + 1} â†’ Spanish Menu`);
  lines.push("  Press * â†’ Repeat Menu");
  if (afterHoursEnabled) { lines.push(""); lines.push("AFTER HOURS: Enabled"); }
  return lines.join("\n");
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STEP 4 RENDER
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderStep4() {
  // Read possibly edited scripts from step 3
  generatedMain = document.getElementById("mainScript").value;
  generatedAH = document.getElementById("ahScript")?.value || "";

  document.getElementById("finalMain").textContent = generatedMain;
  if (generatedAH) {
    document.getElementById("finalAhBox").style.display = "block";
    document.getElementById("finalAh").textContent = generatedAH;
  } else {
    document.getElementById("finalAhBox").style.display = "none";
  }
  document.getElementById("configPreview4").textContent = buildConfig();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EXPORT ACTIONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function copyFullScript() {
  const full = generatedMain + (generatedAH ? "\n\nâ”â”â” AFTER HOURS GREETING â”â”â”\n\n" + generatedAH : "");
  navigator.clipboard.writeText(full).then(() => {
    const btn = document.getElementById("copyBtn");
    btn.textContent = "âœ“ Copied!";
    setTimeout(() => btn.textContent = "ğŸ“‹ Copy Full Script", 2000);
  });
}

function copyConfig() {
  navigator.clipboard.writeText(buildConfig()).then(() => {
    // brief visual feedback could be added here
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ZAPIER WEBHOOK
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function sendToWebhook() {
  const email = document.getElementById("emailInput").value.trim();
  const btn = document.getElementById("sendBtn");
  if (!email || btn.disabled) return;

  btn.disabled = true;
  btn.textContent = "Sendingâ€¦";

  try {
    const full = generatedMain + (generatedAH ? "\n\nâ”â”â” AFTER HOURS GREETING â”â”â”\n\n" + generatedAH : "");
    await fetch("https://hooks.zapier.com/hooks/catch/2630762/uc1zyf1/", {
      method: "POST",
      body: JSON.stringify({
        email: email,
        cc: "onetalk@officecommunications.net",
        businessName: document.getElementById("businessName").value.trim(),
        industry: templates[selectedIndustry].name,
        tone: selectedTone,
        hours: document.getElementById("businessHours").value.trim(),
        departments: departments.filter(d => d.name.trim()).map(d => ({
          name: d.name,
          extension: d.extension,
          ringType: d.ring === "simultaneous" ? "Ring All" : "Ring in Order",
        })),
        mainScript: generatedMain,
        afterHoursScript: generatedAH,
        configSummary: buildConfig(),
        fullScript: full,
        includeSpanish: document.getElementById("includeSpanish").checked,
        operatorExtension: document.getElementById("operatorExt").value.trim(),
        timestamp: new Date().toISOString(),
      }),
    });
    btn.textContent = "âœ“ Sent!";
    setTimeout(() => { btn.textContent = "Send"; btn.disabled = false; }, 4000);
  } catch (err) {
    console.error("Webhook error:", err);
    alert("Something went wrong sending the script. Please try again or copy the script manually.");
    btn.textContent = "Send";
    btn.disabled = false;
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UTIL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function escHtml(str) {
  return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
init();
</script>
</body>
</html>

